<div id="container">
	<table border='1' width='100%' id="members-table">

	</table>
</div>

<script type="text/javascript">
	var members = [
	{% for member in page.header.members %}
	{
		name: "{{member.name}}",
		
		position: [
		{% for pos in member.position %}
			"{{pos}}",
		{% endfor %}
		],
		
		pic: "{{(member.picture |first).path}}",
	},
	
	{% endfor %}
	];
	
	var memDisplayWidth = 320;
	
	function displayTable() {		
		var col = parseInt(parseInt($('#container').width()) / memDisplayWidth);
		var table = document.getElementById("members-table");
		var rowCount = 0;
		var cellCount = 0; //Does not include president.
		
		console.log(col);
		
		//Refresh table.
		table.innerHTML = "";
		
		for(i=0; i<members.length; i++){
			if(members[i].position.includes('President')){
				rowCount++;
				var row = table.insertRow(0);
				
				var cell = row.insertCell(0);
				cell.align = "center";
				cell.className = "member-president";
				cell.colSpan = col;
				cell.innerHTML =	'<img src="' + members[i].pic + '"/>'
								+	members[i].name
								+	positionToList(members[i].position, true);
			} else {				
				var row;
				
				//If the row has been filled...
				if(cellCount % col == 0){
					var row = table.insertRow(rowCount);
					rowCount++;
				} else {
					row = table.rows[rowCount - 1]; //Arrays ya know
				}
				
				var cell = row.insertCell(cellCount % col);
				cell.align = "center";
				cell.className = "member";
				cell.innerHTML =	'<img src="' + members[i].pic + '"/>'
								+	members[i].name
								+	positionToList(members[i].position, false);
								
				cellCount++;
			}
		}
	}
	
	function positionToList(positionArr, president){
		var pos = "";

		//Skip the president position.
		var start = president ? 1 : 0;
		
		for(j=start; j<positionArr.length; j++){
			pos += positionArr[j];
			
			//Don't add a comma for the last position.
			if(j < positionArr.length - 1){
				pos += ", ";
			}
		}
		
		return pos;
	}
	
	$(document).ready(displayTable);
	$(window).resize(displayTable);
</script>